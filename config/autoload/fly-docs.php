<?php

declare(strict_types=1);

use function Hyperf\Support\env;

return [

    /*
    |--------------------------------------------------------------------------
    | Коллекции документации
    |--------------------------------------------------------------------------
    | Каждая коллекция соответствует отдельной странице Swagger UI.
    | "latest" — основная, объединяющая все теги или явно заданный список.
    */
    'collections' => [

        'latest' => [
            // Список тегов, которые попадут в эту коллекцию.
            // Можно ['*'] — чтобы включить все теги.
            'include_tags' => ['*'],

            // Метаданные спецификации
            'info' => [
                'title' => 'API (latest)',
                'version' => '1.0.0',
                'description' => 'Полуавтоматическая документация API под Hyperf',
            ],

            // Сервера для этой коллекции
            'servers' => [
                [
                    'url' => 'http://localhost:9501',
                    'description' => 'Local environment',
                ],
            ],

            // Опциональные схемы безопасности (пример)
            'security' => [
//                \App\OpenApi\SecuritySchemes\SecuritySchemeContainer::class,
            ],
        ],

        // Пример другой коллекции (по тегу)
        /*
        'User' => [
            'include_tags' => ['User'],
            'info' => [
                'title' => 'User API',
                'version' => '1.0.0',
            ],
        ],
        */
    ],

    /*
    |--------------------------------------------------------------------------
    | Кэширование спецификаций
    |--------------------------------------------------------------------------
    | Все собранные спецификации сохраняются как JSON в runtime/fly-docs.
    | Режим lazy — сборка при первом запросе.
    | Режим boot — сборка при старте воркера.
    */
    'cache' => [
        'dir' => '/runtime/fly-docs',
        'mode' => env('FLY_DOCS_MODE', 'lazy'), // lazy | boot
        'dev_ttl_seconds' => (int) (env('FLY_DOCS_DEV_TTL', 0)), // 0 = только по checksum
    ],

    /*
    |--------------------------------------------------------------------------
    | Настройки UI
    |--------------------------------------------------------------------------
    | Используется встроенный Swagger UI (CDN или локальные ассеты).
    */
    'ui' => [
        'index_title' => 'API Docs',
    ],

    'security_definitions' => [
        /*
         * Единственная точка подключения авторизации в OpenAPI.
         * Укажи один или несколько контейнеров, которые:
         *1) регистрируют securitySchemes в components;
         *2) возвращают глобальные требования security для всех операций.
         */
        'security_schemes' => [
//            \App\OpenApi\SecuritySchemes\SecuritySchemeContainer::class,
        ],
    ],
];
